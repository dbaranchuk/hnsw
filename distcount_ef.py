rnd_1m_1NN = '''1	0.2374	17.9146 us	157.672 dcs
2	0.3674	23.9159 us	190.471 dcs
3	0.4545	28.7419 us	216.28 dcs
4	0.5205	33.2675 us	239.568 dcs
5	0.5718	38.0368 us	260.473 dcs
6	0.6122	41.6388 us	279.662 dcs
7	0.6506	45.0693 us	297.698 dcs
8	0.681	49.0889 us	315.387 dcs
9	0.7051	52.0889 us	332.138 dcs
10	0.7267	55.6307 us	348.609 dcs
11	0.7452	58.5649 us	364.408 dcs
12	0.7607	61.8385 us	380.008 dcs
13	0.7761	64.7421 us	395.59 dcs
14	0.7893	67.9093 us	410.356 dcs
15	0.803	70.6564 us	425.369 dcs
16	0.8133	73.8829 us	439.48 dcs
17	0.8235	76.4803 us	453.79 dcs
18	0.8316	79.4793 us	467.752 dcs
19	0.8406	82.2239 us	482.126 dcs
20	0.8494	85.2882 us	496.166 dcs
21	0.8554	87.8208 us	509.798 dcs
22	0.8603	90.9428 us	523.967 dcs
23	0.8647	93.6069 us	537.471 dcs
24	0.8715	96.416 us	551.149 dcs
25	0.8773	99.0406 us	564.826 dcs
26	0.8825	101.807 us	578.082 dcs
27	0.8866	104.735 us	591.155 dcs
28	0.8905	107.137 us	604.778 dcs
29	0.8944	109.599 us	617.926 dcs
30	0.8974	112.278 us	630.867 dcs
40	0.9257	139.139 us	760.884 dcs
50	0.9447	168.674 us	888.034 dcs
60	0.9564	192.143 us	1011.8 dcs
70	0.9653	218.811 us	1133.12 dcs
80	0.9723	244.05 us	1253.61 dcs
90	0.9761	272.474 us	1371.43 dcs
100	0.9795	289.525 us	1487.99 dcs
140	0.9886	386.973 us	1937.76 dcs
180	0.992	488.271 us	2366.32 dcs
220	0.9937	576.695 us	2779.62 dcs
260	0.9949	686.74 us	3180.3 dcs
300	0.9959	753.414 us	3569.61 dcs
340	0.9968	842.306 us	3949.1 dcs
380	0.9974	930.437 us	4320.56 dcs
420	0.9974	1019.61 us	4684.89 dcs
460	0.998	1102.31 us	5042.65 dcs
'''
one_layer_1m_1NN = '''1	0.1965	26.5523 us	162.804 dcs
2	0.3533	28.493 us	207.209 dcs
3	0.4491	43.2816 us	237.403 dcs
4	0.5204	45.5433 us	262.257 dcs
5	0.5725	72.2591 us	284.263 dcs
6	0.6189	80.013 us	304.739 dcs
7	0.6534	85.1155 us	323.19 dcs
8	0.6846	93.0424 us	340.935 dcs
9	0.7095	89.9358 us	358.335 dcs
10	0.7284	65.6097 us	375.095 dcs
11	0.7456	93.3133 us	390.399 dcs
12	0.7636	116.085 us	406.38 dcs
13	0.7794	88.0436 us	421.218 dcs
14	0.7926	95.5283 us	436.111 dcs
15	0.8046	109.255 us	451.189 dcs
16	0.8157	129.779 us	466.055 dcs
17	0.8271	93.3492 us	480.239 dcs
18	0.8371	92.3557 us	494.192 dcs
19	0.8437	133.854 us	508.037 dcs
20	0.8514	153.528 us	521.835 dcs
21	0.8592	113.954 us	535.662 dcs
22	0.8647	104.159 us	549.472 dcs
23	0.8695	127.032 us	562.828 dcs
24	0.8739	156.187 us	576.627 dcs
25	0.8789	177.921 us	590.114 dcs
26	0.8841	175.81 us	603.23 dcs
27	0.8884	184.477 us	616.444 dcs
28	0.8927	137.755 us	629.998 dcs
29	0.8968	187.147 us	643.083 dcs
30	0.9003	149.008 us	656.415 dcs
40	0.9276	192.77 us	785.545 dcs
50	0.9451	255.56 us	911.478 dcs
60	0.9571	299.419 us	1034.99 dcs
70	0.9653	277.684 us	1156.21 dcs
80	0.9727	370.163 us	1276.09 dcs
90	0.977	356.656 us	1392.94 dcs
100	0.9799	399.32 us	1508.88 dcs
140	0.989	512.855 us	1956.86 dcs
180	0.9924	670.022 us	2384.56 dcs
220	0.9944	759.178 us	2797.26 dcs
260	0.9957	871.733 us	3197.12 dcs
300	0.9967	1012.87 us	3586.35 dcs
340	0.9974	1150.33 us	3965.4 dcs
380	0.9977	1252.73 us	4336.41 dcs
420	0.9981	1270.22 us	4699.89 dcs
460	0.9985	1378.72 us	5057.65 dcs
'''

rnd_10m_1NN = '''1	0.1745	64.5733 us	174.229 dcs
2	0.2821	77.9547 us	210.051 dcs
3	0.3605	89.8214 us	240.311 dcs
4	0.4197	101.58 us	267.378 dcs
5	0.4724	111.119 us	291.521 dcs
6	0.5123	121.633 us	314.346 dcs
7	0.5466	129.469 us	335.607 dcs
8	0.5774	141.011 us	355.767 dcs
9	0.5984	146.14 us	374.693 dcs
10	0.6201	154.514 us	393.121 dcs
11	0.6399	163.686 us	411.15 dcs
12	0.6609	169.2 us	429.695 dcs
13	0.6778	176.596 us	446.904 dcs
14	0.6905	187.484 us	464.158 dcs
15	0.7057	190.289 us	481.354 dcs
16	0.7182	201.053 us	498.141 dcs
17	0.7297	219.611 us	514.522 dcs
18	0.7389	227.105 us	530.336 dcs
19	0.7481	236.896 us	545.959 dcs
20	0.7571	230.288 us	561.979 dcs
21	0.7645	240.343 us	577.676 dcs
22	0.7713	255.706 us	593.311 dcs
23	0.7776	263.603 us	608.664 dcs
24	0.7857	257.428 us	624.728 dcs
25	0.7922	257.514 us	639.684 dcs
26	0.7996	263.681 us	655.374 dcs
27	0.8045	272.164 us	669.937 dcs
28	0.8088	276.102 us	685.06 dcs
29	0.8151	282.618 us	700.214 dcs
30	0.8201	292.986 us	715.424 dcs
40	0.86	354.24 us	861.661 dcs
50	0.884	414.157 us	1005.2 dcs
60	0.8999	475.149 us	1146.2 dcs
70	0.9141	544.51 us	1283.96 dcs
80	0.925	594.005 us	1421.69 dcs
90	0.9341	646.553 us	1556.31 dcs
100	0.9414	713.421 us	1689.66 dcs
140	0.9613	941.333 us	2211.59 dcs
180	0.9702	1198.55 us	2714.18 dcs
220	0.9765	1432.28 us	3203.74 dcs
260	0.9816	1690.17 us	3681.22 dcs
300	0.9846	1868.31 us	4147.38 dcs
340	0.9862	2068.59 us	4605.3 dcs
380	0.9878	2341.9 us	5055.48 dcs
420	0.9895	2599.56 us	5499.03 dcs
460	0.9902	2799.67 us	5935.47 dcs
'''

one_layer_10m_1NN = '''1	0.116	46.6334 us	177.49 dcs
2	0.246	55.7274 us	237.243 dcs
3	0.3338	76.2752 us	276.978 dcs
4	0.398	94.6589 us	307.832 dcs
5	0.4526	107.23 us	334.987 dcs
6	0.4941	101.054 us	359 dcs
7	0.5309	115.326 us	382.139 dcs
8	0.5619	100.219 us	403.921 dcs
9	0.5879	93.4656 us	424.517 dcs
10	0.614	103.657 us	444.236 dcs
11	0.636	132.352 us	462.935 dcs
12	0.6551	102.186 us	481.197 dcs
13	0.6727	128.007 us	498.846 dcs
14	0.6868	145.096 us	516.237 dcs
15	0.7029	153.28 us	533.785 dcs
16	0.7143	149.985 us	550.51 dcs
17	0.7266	167.171 us	567.08 dcs
18	0.7382	171.533 us	583.749 dcs
19	0.7479	198.475 us	600.549 dcs
20	0.757	161.169 us	617.061 dcs
21	0.7636	207.318 us	632.987 dcs
22	0.7722	168.257 us	648.923 dcs
23	0.7799	189.673 us	664.03 dcs
24	0.7875	163.332 us	679.627 dcs
25	0.7943	155.623 us	695.215 dcs
26	0.8007	195.672 us	711.019 dcs
27	0.8063	258.605 us	726.265 dcs
28	0.8129	170.039 us	741.457 dcs
29	0.8182	179.467 us	757.109 dcs
30	0.8235	179.81 us	772.053 dcs
40	0.8601	279.226 us	917.687 dcs
50	0.8852	330.99 us	1061.11 dcs
60	0.9038	338.275 us	1200.37 dcs
70	0.9191	467.589 us	1338.06 dcs
80	0.9297	470.597 us	1475.06 dcs
90	0.9391	494.274 us	1609.81 dcs
100	0.9458	597.963 us	1743.26 dcs
140	0.9629	631.844 us	2262.82 dcs
180	0.974	866.64 us	2767.46 dcs
220	0.9792	943.599 us	3255.76 dcs
260	0.9833	1123.13 us	3732.71 dcs
300	0.9857	1395.14 us	4199.96 dcs
340	0.9877	1624.71 us	4658.33 dcs
380	0.989	1748.33 us	5108 dcs
420	0.9901	1869.46 us	5550.77 dcs
460	0.9911	1988.23 us	5987.52 dcs
'''

rnd_100m_1NN = '''1	0.1237	54.542 us	200.566 dcs
2	0.2113	52.8029 us	241.013 dcs
3	0.2804	61.059 us	275.221 dcs
4	0.3343	68.2885 us	304.722 dcs
5	0.3794	75.0735 us	332.158 dcs
6	0.4158	81.4324 us	357.919 dcs
7	0.4476	90.7394 us	381.763 dcs
8	0.4726	92.7959 us	404.334 dcs
9	0.497	99.0888 us	426.04 dcs
10	0.5193	104.012 us	448.222 dcs
11	0.54	109.16 us	469.349 dcs
12	0.5561	114.163 us	489.071 dcs
13	0.571	119.133 us	508.856 dcs
14	0.5883	127.657 us	529.088 dcs
15	0.6023	128.578 us	548.228 dcs
16	0.6135	136.647 us	566.856 dcs
17	0.6247	139.992 us	584.91 dcs
18	0.634	142.862 us	603.252 dcs
19	0.6455	147.445 us	620.922 dcs
20	0.6556	155.32 us	638.747 dcs
21	0.6647	157.115 us	656.22 dcs
22	0.6733	161.038 us	674.059 dcs
23	0.6807	165.504 us	691.89 dcs
24	0.6891	170.962 us	709.531 dcs
25	0.6953	175.096 us	726.922 dcs
26	0.7022	177.285 us	744.136 dcs
27	0.7079	185.303 us	761.082 dcs
28	0.7136	186.116 us	777.747 dcs
29	0.7198	191.087 us	794.821 dcs
30	0.7265	194.409 us	811.142 dcs
40	0.776	237.132 us	974.741 dcs
50	0.8083	277.897 us	1134.04 dcs
60	0.8307	320.597 us	1289.83 dcs
70	0.8493	357.361 us	1444.1 dcs
80	0.8631	396.985 us	1596.07 dcs
90	0.8758	436.356 us	1746.57 dcs
100	0.8847	475.35 us	1895.29 dcs
140	0.9138	630.604 us	2480.99 dcs
180	0.931	784.213 us	3053.52 dcs
220	0.9416	910.243 us	3611.01 dcs
260	0.9495	991.903 us	4159.35 dcs
300	0.9559	1124.06 us	4699.15 dcs
340	0.9621	1259.83 us	5229.61 dcs
380	0.966	1398.1 us	5752.45 dcs
420	0.9693	1538.22 us	6268.52 dcs
460	0.971	1665.55 us	6779.09 dcs
'''
one_layer_100m_1NN = '''1	0.0642	35.8097 us	188.718 dcs
2	0.1585	63.1393 us	262.413 dcs
3	0.23	68.9629 us	311.151 dcs
4	0.2874	68.3618 us	349.118 dcs
5	0.3335	77.3178 us	381.542 dcs
6	0.3692	83.9058 us	410.006 dcs
7	0.4045	90.2629 us	438.146 dcs
8	0.4363	97.5513 us	464.121 dcs
9	0.4627	111.85 us	488.462 dcs
10	0.4875	109.531 us	511.861 dcs
11	0.5057	115.066 us	534.084 dcs
12	0.5204	121.179 us	555.123 dcs
13	0.5349	123.637 us	575.727 dcs
14	0.5527	130.867 us	597.211 dcs
15	0.5688	140.002 us	617.009 dcs
16	0.582	139.196 us	635.845 dcs
17	0.5935	143.908 us	654.984 dcs
18	0.6043	149.268 us	674.161 dcs
19	0.6153	158.03 us	692.959 dcs
20	0.6251	161.904 us	711.87 dcs
21	0.635	168.193 us	730.383 dcs
22	0.6438	177.859 us	748.382 dcs
23	0.6527	175.882 us	766.192 dcs
24	0.6624	180.516 us	784.539 dcs
25	0.6702	183.894 us	802.005 dcs
26	0.6766	188.28 us	819.304 dcs
27	0.6831	192.377 us	836.854 dcs
28	0.6892	206.276 us	854.118 dcs
29	0.696	201.174 us	871.085 dcs
30	0.7025	205.778 us	888.338 dcs
40	0.7499	249.859 us	1055.32 dcs
50	0.7825	289.723 us	1216.79 dcs
60	0.8083	328.217 us	1373.85 dcs
70	0.8272	368.157 us	1530.02 dcs
80	0.8453	414.477 us	1683.84 dcs
90	0.8591	446.619 us	1835.03 dcs
100	0.871	484.983 us	1986.37 dcs
140	0.8989	637.134 us	2574.52 dcs
180	0.9172	788.332 us	3146.54 dcs
220	0.9289	935.78 us	3707.12 dcs
260	0.9389	1083.2 us	4258.11 dcs
300	0.9472	1225.74 us	4800.12 dcs
340	0.9536	1371.88 us	5332.82 dcs
380	0.9569	1515.72 us	5856.67 dcs
420	0.9611	1658.15 us	6376.23 dcs
460	0.965	1800.23 us	6891.04 dcs
'''

import os
import matplotlib.pyplot as plt
import numpy
import re

M = 1

splitted_rnd = re.findall(r"[0-9.]+", rnd_1m_1NN)
splitted_one_layer = re.findall(r"[0-9.]+", one_layer_1m_1NN)

ef = range(1,30) + range(30, 100, 10) + range(100, 500, 40)


rnd_recall = splitted_rnd[1::4]
one_layer_recall = splitted_one_layer[1::4]

plt.plot(ef, rnd_recall, 'r--')
plt.plot(ef, one_layer_recall)
plt.axis([1, 460, 0, 1])
plt.xlabel('Ef', fontsize=14)
plt.ylabel('Recall@R', fontsize=14)
plt.text(ef[-1]+1, rnd_recall[-1], 'HNSW', fontsize=11, color=(1,0,0))
plt.text(ef[-1]+1, float(rnd_recall[-1])-0.05, 'One Layer', fontsize=11, color=(0,0,1))
plt.title('SIFT ' + str(M) + 'M 1NN Recall/Ef')
plt.savefig('recall_ef' + str(M) + 'M1NN.png')
#plt.s:ow()
